--- .orig/usr/lib/luna/system/luna-systemui/app/controllers/bar-assistant.js
+++ /usr/lib/luna/system/luna-systemui/app/controllers/bar-assistant.js
@@ -3,6 +3,7 @@
 var BarAssistant = Foundations.Class.create({
 	
 	setup: function() {
+		this.modeSwitcherConfig = {};
 						
 		this.showMSMWarning = false;
 		this.isUSBConnected = false;
@@ -609,6 +610,9 @@
 	
 	this.getRoamingPreference();
 		
+	//Subscribe to Mode Switcher configuration
+	this.initModeSwitcher();
+	
 	//Get the Airplane Mode initial values
 	this.isAirplaneModeEnabled();
 						
@@ -717,7 +721,7 @@
 				this.carrierText = $L(payload.extended.networkName.escapeHTML());
 				this.currentCarrierText = payload.extended.networkName.escapeHTML();
 			}
-			Mojo.Dom.get('carrier').innerHTML = this.carrierText;	   	
+			this.updateModeSwitcherStatus();
 			if(payload.extended.registration == 'home') {			
 				Mojo.Dom.get('roaming').hide();
 			}								
@@ -1136,7 +1140,7 @@
 					this.carrierText = $L(networkMsg.networkName.escapeHTML());
 					this.currentCarrierText = networkMsg.networkName.escapeHTML();
 				}
-				Mojo.Dom.get('carrier').innerHTML = this.carrierText;
+				this.updateModeSwitcherStatus();
 				this.simlocked = false;
 				
 				if(networkMsg.registration == 'home') {					
@@ -4569,6 +4573,95 @@
 	Mojo.Controller.getAppController().showBanner(bannerParams, {}, 'textassistbanner');
 },
 
+// Mode Switcher Support
+
+initModeSwitcher: function() {
+	this.defaultCarrierColor = Mojo.Dom.get('carrier').style.color;
+	
+	this.modesConfigRequest = new Mojo.Service.Request("palm://com.palm.systemservice/", {
+		method: 'getPreferences', 
+		parameters: {"subscribe":true,"keys":["modeSwitcher", "modesConfig", 
+			"currentMode", "defaultMode", "modifierModes"]},
+		onSuccess: this.handleModeSwitcherUpdate.bind(this) });	
+},
+
+handleModeSwitcherUpdate: function(payload) {
+	if(payload.modeSwitcher != undefined) {
+		this.modeSwitcherConfig.modeSwitcher = payload.modeSwitcher;
+		
+		this.updateModeSwitcherStatus();
+	}
+		
+	if(payload.modesConfig != undefined) {
+		this.modeSwitcherConfig.modesConfig = payload.modesConfig;
+	}
+
+	if(payload.currentMode != undefined) {
+	 	if(payload.currentMode != "none")
+			this.modeSwitcherConfig.currentMode = payload.currentMode;
+		else
+			this.modeSwitcherConfig.currentMode = null;
+
+		this.updateModeSwitcherStatus();
+	}
+
+	if(payload.defaultMode != undefined) {
+	 	if(payload.defaultMode != "none")
+			this.modeSwitcherConfig.defaultMode = payload.defaultMode;
+		else
+			this.modeSwitcherConfig.defaultMode = null;
+	}
+	
+	if(payload.modifierModes != undefined) {
+		this.modeSwitcherConfig.modifierModes = payload.modifierModes;
+
+		this.updateModeSwitcherStatus();
+	}
+
+	var stageController = Mojo.Controller.getAppController().getStageController("StatusMenu");	
+
+	if(stageController) {
+		stageController.delegateToSceneAssistant("updateMenuItems");
+	}
+},
+
+//Updated the status text if needed.
+updateModeSwitcherStatus: function() {
+	if(!this.modeSwitcherConfig.currentMode) {
+		$('carrier').innerHTML = this.carrierText;
+		$('carrier').style.color = this.defaultCarrierColor;
+
+		return;
+	}	
+	
+	if(this.modeSwitcherConfig.modeSwitcher.modeLocked == "yes")
+		$('carrier').style.color = "yellow";
+	else
+		$('carrier').style.color = this.defaultCarrierColor;
+				
+	if((this.modeSwitcherConfig.modifierModes) && 
+		(this.modeSwitcherConfig.modifierModes.length > 0))
+	{
+		if(this.modeSwitcherConfig.currentMode.type == "default")
+			var statusText = this.carrierText + " +";
+		else
+			var statusText = this.modeSwitcherConfig.currentMode.name + " +";
+	}
+	else {
+		if(this.modeSwitcherConfig.currentMode.type == "default")
+			var statusText = this.carrierText;
+		else
+			var statusText = this.modeSwitcherConfig.currentMode.name;
+	}
+
+	$('carrier').innerHTML = statusText;
+},
+
+//Returns the MS config. Called by the Mode Menu.
+getModeSwitcherConfig: function() {	
+	return this.modeSwitcherConfig;
+},
+
 //  Main Variables
 	timeAMPM: true,
 	serviceInitMethod:[],
--- .orig/usr/lib/luna/system/luna-systemui/sources.json
+++ /usr/lib/luna/system/luna-systemui/sources.json
@@ -6,6 +6,9 @@
     "source": "app\/controllers\/bar-assistant.js"
   },  
   {
+    "source": "app\/controllers\/statusmenu-assistant.js"
+  },  
+  {
     "source": "app\/controllers\/devicemenu-assistant.js"
   },  
   {
--- .orig/usr/lib/luna/system/luna-systemui/resources/de/strings.json
+++ /usr/lib/luna/system/luna-systemui/resources/de/strings.json
@@ -1,4 +1,29 @@
 {
+	"Menu Content Settings": "",
+	"Toggle Airplane Mode": "",
+	"Status: Default Settings": "",
+	"Status: Normal Settings": "",
+	"Status: Modified Settings": "",
+	"Configure Mode Switcher": "",
+	"Mode Switcher Disabled": "",
+	"Enable Mode Switcher": "",
+	"Disable Mode Switcher": "",
+	"Enabling Mode Switcher": "",
+	"Disabling Mode Switcher": "",
+	"Enable Mode Triggers": "",
+	"Disable Mode Triggers": "",
+	"Enabling Mode Triggers": "",
+	"Disabling Mode Triggers": "",
+	"Start": "",
+	"Close": "",
+	"Switch to": "",
+	"Starting": "",
+	"Closing": "",
+	"Switching to": "",
+	"Now": "",
+	"This Mode is Starting": "",
+	"This Mode is Closing": "",
+	"Switching to This Mode": "",
 	" access to your contacts?": " Zugriff auf Ihre Kontakte gewähren?",
 	" hr": " Std.",
 	" min": " Min.",
--- .orig/usr/lib/luna/system/luna-systemui/resources/es/strings.json
+++ /usr/lib/luna/system/luna-systemui/resources/es/strings.json
@@ -1,4 +1,29 @@
 {
+	"Menu Content Settings": "",
+	"Toggle Airplane Mode": "",
+	"Status: Default Settings": "",
+	"Status: Normal Settings": "",
+	"Status: Modified Settings": "",
+	"Configure Mode Switcher": "",
+	"Mode Switcher Disabled": "",
+	"Enable Mode Switcher": "",
+	"Disable Mode Switcher": "",
+	"Enabling Mode Switcher": "",
+	"Disabling Mode Switcher": "",
+	"Enable Mode Triggers": "",
+	"Disable Mode Triggers": "",
+	"Enabling Mode Triggers": "",
+	"Disabling Mode Triggers": "",
+	"Start": "",
+	"Close": "",
+	"Switch to": "",
+	"Starting": "",
+	"Closing": "",
+	"Switching to": "",
+	"Now": "",
+	"This Mode is Starting": "",
+	"This Mode is Closing": "",
+	"Switching to This Mode": "",
 	" access to your contacts?": " tenga acceso a tus contactos?",
 	" hr": " h",
 	" min": " m",
--- .orig/usr/lib/luna/system/luna-systemui/resources/fr/strings.json
+++ /usr/lib/luna/system/luna-systemui/resources/fr/strings.json
@@ -1,4 +1,29 @@
 {
+	"Menu Content Settings": "",
+	"Toggle Airplane Mode": "",
+	"Status: Default Settings": "",
+	"Status: Normal Settings": "",
+	"Status: Modified Settings": "",
+	"Configure Mode Switcher": "",
+	"Mode Switcher Disabled": "",
+	"Enable Mode Switcher": "",
+	"Disable Mode Switcher": "",
+	"Enabling Mode Switcher": "",
+	"Disabling Mode Switcher": "",
+	"Enable Mode Triggers": "",
+	"Disable Mode Triggers": "",
+	"Enabling Mode Triggers": "",
+	"Disabling Mode Triggers": "",
+	"Start": "",
+	"Close": "",
+	"Switch to": "",
+	"Starting": "",
+	"Closing": "",
+	"Switching to": "",
+	"Now": "",
+	"This Mode is Starting": "",
+	"This Mode is Closing": "",
+	"Switching to This Mode": "",
 	" access to your contacts?": " accéder à vos contacts ?",
 	" hr": " h",
 	" sec": " s",
--- .orig/usr/lib/luna/system/luna-systemui/resources/it/strings.json
+++ /usr/lib/luna/system/luna-systemui/resources/it/strings.json
@@ -1,4 +1,29 @@
 {
+	"Menu Content Settings": "",
+	"Toggle Airplane Mode": "",
+	"Status: Default Settings": "",
+	"Status: Normal Settings": "",
+	"Status: Modified Settings": "",
+	"Configure Mode Switcher": "",
+	"Mode Switcher Disabled": "",
+	"Enable Mode Switcher": "",
+	"Disable Mode Switcher": "",
+	"Enabling Mode Switcher": "",
+	"Disabling Mode Switcher": "",
+	"Enable Mode Triggers": "",
+	"Disable Mode Triggers": "",
+	"Enabling Mode Triggers": "",
+	"Disabling Mode Triggers": "",
+	"Start": "",
+	"Close": "",
+	"Switch to": "",
+	"Starting": "",
+	"Closing": "",
+	"Switching to": "",
+	"Now": "",
+	"This Mode is Starting": "",
+	"This Mode is Closing": "",
+	"Switching to This Mode": "",
 	" access to your contacts?": " l’accesso ai propri contatti?",
 	" hr": " h",
 	" min": " min.",
